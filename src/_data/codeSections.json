[
  {
    "id": "html-product-card",
    "title": "HTML Product Card with BEM",
    "description": "Semantic product card structure using BEM naming conventions and UCP-ready data attributes",
    "category": "html",
    "tags": ["bem", "semantic", "product-card", "data-attributes", "ucp"],
    "language": "html",
    "order": 1,
    "code": "<!-- Product Card Component with UCP-Ready Data Attributes -->\n<div class=\"product-card\"\n     data-product-id=\"prod-12345\"\n     data-product-sku=\"HD-CLAY-001\"\n     data-ucp-entity=\"product\">\n\n  <!-- Product Image -->\n  <div class=\"product-card__image-container\">\n    <img class=\"product-card__image\"\n         src=\"/images/american-crew-clay.jpg\"\n         alt=\"American Crew Matte Clay\">\n  </div>\n\n  <!-- Product Details -->\n  <div class=\"product-card__details\">\n    <h3 class=\"product-card__title\" data-field=\"title\">\n      American Crew Matte Clay\n    </h3>\n    \n    <p class=\"product-card__price\"\n       data-field=\"price\"\n       data-currency=\"USD\"\n       data-value=\"24.99\">\n      $24.99\n    </p>\n    \n    <p class=\"product-card__description\">\n      High hold with matte finish. Perfect for short to medium hair styles.\n    </p>\n  </div>\n\n  <!-- Product Actions -->\n  <div class=\"product-card__actions\">\n    <button class=\"product-card__button product-card__button--primary\"\n            data-action=\"add-to-cart\"\n            data-item-id=\"prod-12345\"\n            data-item-name=\"American Crew Matte Clay\"\n            data-item-brand=\"American Crew\"\n            data-item-category=\"Hair Styling\"\n            data-item-price=\"24.99\"\n            data-currency=\"USD\">\n      Add to Cart\n    </button>\n    \n    <button class=\"product-card__button product-card__button--secondary\"\n            data-action=\"view-details\"\n            data-item-id=\"prod-12345\">\n      View Details\n    </button>\n  </div>\n</div>"
  },
  {
    "id": "ucp-integration",
    "title": "UCP Integration Class",
    "description": "JavaScript class for managing Universal Commerce Protocol authentication and session state",
    "category": "javascript",
    "tags": ["ucp", "authentication", "session", "token", "middleware"],
    "language": "javascript",
    "order": 2,
    "code": "/**\n * Universal Commerce Protocol Integration\n * Manages user authentication, session state, and token handling\n */\nclass UCPIntegration {\n  constructor(config) {\n    this.apiEndpoint = config.apiEndpoint || 'https://api.ucp.example.com';\n    this.middlewareUrl = config.middlewareUrl; // Xano or n8n endpoint\n    this.token = null;\n    this.userId = null;\n    this.sessionId = null;\n    this.init();\n  }\n  \n  /**\n   * Initialize UCP session\n   */\n  async init() {\n    // Check for existing token in localStorage\n    this.token = localStorage.getItem('ucp_token');\n    \n    if (this.token) {\n      await this.validateToken();\n    } else {\n      await this.createSession();\n    }\n  }\n  \n  /**\n   * Create new UCP session\n   */\n  async createSession() {\n    try {\n      const response = await fetch(`${this.middlewareUrl}/create-session`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          timestamp: Date.now(),\n          referrer: document.referrer,\n          userAgent: navigator.userAgent\n        })\n      });\n      \n      const data = await response.json();\n      \n      this.token = data.token;\n      this.userId = data.userId;\n      this.sessionId = data.sessionId;\n      \n      // Store token\n      localStorage.setItem('ucp_token', this.token);\n      localStorage.setItem('ucp_session_id', this.sessionId);\n      \n      console.log('UCP Session Created:', this.sessionId);\n    } catch (error) {\n      console.error('UCP Session Creation Failed:', error);\n    }\n  }\n  \n  /**\n   * Validate existing token\n   */\n  async validateToken() {\n    try {\n      const response = await fetch(`${this.middlewareUrl}/validate-token`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${this.token}`\n        }\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        this.userId = data.userId;\n        this.sessionId = data.sessionId;\n        console.log('UCP Token Valid');\n      } else {\n        // Token invalid, create new session\n        await this.createSession();\n      }\n    } catch (error) {\n      console.error('UCP Token Validation Failed:', error);\n      await this.createSession();\n    }\n  }\n  \n  /**\n   * Get hashed token for analytics (privacy-safe)\n   */\n  getHashedToken() {\n    if (!this.token) return null;\n    \n    // Simple hash for demonstration\n    // In production, use proper crypto hashing\n    let hash = 0;\n    for (let i = 0; i < this.token.length; i++) {\n      const char = this.token.charCodeAt(i);\n      hash = ((hash << 5) - hash) + char;\n      hash = hash & hash;\n    }\n    return 'ucp_' + Math.abs(hash).toString(36);\n  }\n  \n  /**\n   * Update user context\n   */\n  async updateContext(contextData) {\n    try {\n      await fetch(`${this.middlewareUrl}/update-context`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${this.token}`\n        },\n        body: JSON.stringify({\n          sessionId: this.sessionId,\n          context: contextData\n        })\n      });\n    } catch (error) {\n      console.error('UCP Context Update Failed:', error);\n    }\n  }\n}\n\n// Initialize UCP\nconst ucp = new UCPIntegration({\n  middlewareUrl: 'https://your-middleware.xano.io/api:v1'\n});"
  },
  {
    "id": "ga4-event-tracker",
    "title": "GA4 Event Tracker",
    "description": "Complete GA4 ecommerce tracking with UCP integration for purchase, add to cart, and checkout events",
    "category": "javascript",
    "tags": ["ga4", "analytics", "ecommerce", "tracking", "datalayer"],
    "language": "javascript",
    "order": 3,
    "code": "/**\n * GA4 Event Tracking with UCP Integration\n * Implements Google Analytics 4 ecommerce tracking with Universal Commerce Protocol\n */\nclass GA4EventTracker {\n  constructor(ucpInstance) {\n    this.ucp = ucpInstance;\n    this.dataLayer = window.dataLayer || [];\n    window.dataLayer = this.dataLayer;\n  }\n  \n  /**\n   * Track Add to Cart Event\n   * Fires when user clicks \"Add to Cart\" button\n   */\n  trackAddToCart(element) {\n    const productCard = element.closest('.product-card');\n    \n    // Extract data from BEM-structured HTML\n    const eventData = {\n      event: 'add_to_cart',\n      \n      // UCP User Context\n      user_id: this.ucp.userId,\n      ucp_token_hash: this.ucp.getHashedToken(),\n      ucp_session_id: this.ucp.sessionId,\n      \n      // Element Context (captured by GTM)\n      element_id: element.id,\n      element_class: element.className,\n      element_label: element.textContent.trim(),\n      element_action: element.getAttribute('data-action'),\n      \n      // Product Data\n      ecommerce: {\n        currency: element.getAttribute('data-currency') || 'USD',\n        value: parseFloat(element.getAttribute('data-item-price')),\n        items: [{\n          item_id: element.getAttribute('data-item-id'),\n          item_name: element.getAttribute('data-item-name'),\n          item_brand: element.getAttribute('data-item-brand'),\n          item_category: element.getAttribute('data-item-category'),\n          price: parseFloat(element.getAttribute('data-item-price')),\n          quantity: 1\n        }]\n      },\n      \n      // UCP Entity Context\n      ucp_entity_type: productCard.getAttribute('data-ucp-entity'),\n      ucp_product_id: productCard.getAttribute('data-product-id'),\n      ucp_product_sku: productCard.getAttribute('data-product-sku')\n    };\n    \n    // Push to data layer\n    this.dataLayer.push(eventData);\n    \n    console.log('GA4 Event: add_to_cart', eventData);\n  }\n  \n  /**\n   * Track Purchase Event\n   * Fires on successful checkout completion\n   */\n  trackPurchase(orderData) {\n    const eventData = {\n      event: 'purchase',\n      \n      // UCP User Context\n      user_id: this.ucp.userId,\n      ucp_token_hash: this.ucp.getHashedToken(),\n      ucp_session_id: this.ucp.sessionId,\n      \n      // Transaction Data\n      ecommerce: {\n        transaction_id: orderData.transaction_id,\n        affiliation: orderData.affiliation || 'Online Store',\n        value: orderData.total,\n        tax: orderData.tax,\n        shipping: orderData.shipping,\n        currency: orderData.currency || 'USD',\n        coupon: orderData.coupon || '',\n        \n        // Items purchased\n        items: orderData.items.map(item => ({\n          item_id: item.product_id,\n          item_name: item.name,\n          item_brand: item.brand,\n          item_category: item.category,\n          item_variant: item.variant || '',\n          price: item.price,\n          quantity: item.quantity,\n          \n          // UCP-specific fields\n          ucp_product_id: item.ucp_product_id,\n          ucp_sku: item.sku\n        }))\n      },\n      \n      // UCP Transaction Context\n      ucp_checkout_id: orderData.ucp_checkout_id,\n      ucp_payment_method: orderData.payment_method,\n      ucp_fulfillment_method: orderData.fulfillment_method\n    };\n    \n    // Push to data layer\n    this.dataLayer.push(eventData);\n    \n    console.log('GA4 Event: purchase', eventData);\n  }\n  \n  /**\n   * Track Begin Checkout Event\n   */\n  trackBeginCheckout(cartData) {\n    const eventData = {\n      event: 'begin_checkout',\n      \n      // UCP User Context\n      user_id: this.ucp.userId,\n      ucp_token_hash: this.ucp.getHashedToken(),\n      ucp_session_id: this.ucp.sessionId,\n      \n      // Cart Data\n      ecommerce: {\n        currency: cartData.currency || 'USD',\n        value: cartData.total,\n        items: cartData.items.map(item => ({\n          item_id: item.product_id,\n          item_name: item.name,\n          item_brand: item.brand,\n          item_category: item.category,\n          price: item.price,\n          quantity: item.quantity\n        }))\n      },\n      \n      // UCP Checkout Context\n      ucp_checkout_id: cartData.checkout_id\n    };\n    \n    this.dataLayer.push(eventData);\n    console.log('GA4 Event: begin_checkout', eventData);\n  }\n}\n\n// Initialize GA4 Tracker\nconst ga4Tracker = new GA4EventTracker(ucp);"
  },
  {
    "id": "event-listeners",
    "title": "Event Listeners with BEM Selectors",
    "description": "Event delegation using stable BEM class selectors for tracking user interactions",
    "category": "javascript",
    "tags": ["event-delegation", "bem", "selectors", "click-tracking"],
    "language": "javascript",
    "order": 4,
    "code": "/**\n * Event Listeners with BEM Selectors\n * Uses event delegation and stable semantic class names\n */\n\n// Add to Cart Event Listener\ndocument.addEventListener('click', function(event) {\n  const button = event.target.closest('.product-card__button[data-action=\"add-to-cart\"]');\n  \n  if (button) {\n    event.preventDefault();\n    \n    // Visual feedback\n    button.setAttribute('data-state', 'loading');\n    button.textContent = 'Adding...';\n    \n    // Track event\n    ga4Tracker.trackAddToCart(button);\n    \n    // Simulate API call\n    setTimeout(() => {\n      button.setAttribute('data-state', 'success');\n      button.textContent = 'Added to Cart';\n      \n      // Reset after 2 seconds\n      setTimeout(() => {\n        button.removeAttribute('data-state');\n        button.textContent = 'Add to Cart';\n      }, 2000);\n    }, 500);\n  }\n});\n\n// View Details Event Listener\ndocument.addEventListener('click', function(event) {\n  const button = event.target.closest('.product-card__button[data-action=\"view-details\"]');\n  \n  if (button) {\n    event.preventDefault();\n    \n    const itemId = button.getAttribute('data-item-id');\n    \n    // Track view_item event\n    window.dataLayer.push({\n      event: 'view_item',\n      user_id: ucp.userId,\n      ucp_token_hash: ucp.getHashedToken(),\n      item_id: itemId\n    });\n    \n    // Navigate to product page\n    window.location.href = `/products/${itemId}`;\n  }\n});\n\n// Checkout Button Event Listener\ndocument.addEventListener('click', function(event) {\n  const button = event.target.closest('.checkout-button');\n  \n  if (button) {\n    event.preventDefault();\n    \n    // Get cart data\n    const cartData = getCartData();\n    \n    // Track begin_checkout\n    ga4Tracker.trackBeginCheckout(cartData);\n    \n    // Navigate to checkout\n    window.location.href = '/checkout';\n  }\n});\n\n/**\n * Helper: Get cart data from DOM or localStorage\n */\nfunction getCartData() {\n  const cartItems = JSON.parse(localStorage.getItem('cart') || '[]');\n  \n  const total = cartItems.reduce((sum, item) => {\n    return sum + (item.price * item.quantity);\n  }, 0);\n  \n  return {\n    checkout_id: 'chk_' + Date.now(),\n    currency: 'USD',\n    total: total,\n    items: cartItems\n  };\n}\n\n/**\n * Helper: Complete purchase tracking\n */\nfunction completePurchase(orderData) {\n  // Track purchase event\n  ga4Tracker.trackPurchase(orderData);\n  \n  // Send to UCP backend\n  fetch(ucp.middlewareUrl + '/complete-purchase', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${ucp.token}`\n    },\n    body: JSON.stringify({\n      sessionId: ucp.sessionId,\n      order: orderData\n    })\n  }).then(response => response.json())\n    .then(data => {\n      console.log('Purchase recorded in UCP:', data);\n    })\n    .catch(error => {\n      console.error('UCP purchase recording failed:', error);\n    });\n  \n  // Clear cart\n  localStorage.removeItem('cart');\n  \n  // Redirect to confirmation\n  window.location.href = '/order-confirmation?id=' + orderData.transaction_id;\n}"
  },
  {
    "id": "product-card-css",
    "title": "Product Card CSS with BEM",
    "description": "BEM-based styling with data attribute state management for product cards",
    "category": "css",
    "tags": ["bem", "css", "product-card", "state-management"],
    "language": "css",
    "order": 5,
    "code": "/**\n * Product Card Component Styles\n * Uses BEM naming convention for maintainability\n */\n\n/* Block: product-card */\n.product-card {\n  display: flex;\n  flex-direction: column;\n  background: #ffffff;\n  border: 1px solid #e0e0e0;\n  transition: box-shadow 0.3s ease;\n}\n\n.product-card:hover {\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n/* Element: product-card__image-container */\n.product-card__image-container {\n  position: relative;\n  width: 100%;\n  padding-top: 100%; /* 1:1 aspect ratio */\n  overflow: hidden;\n  background: #f5f5f5;\n}\n\n/* Element: product-card__image */\n.product-card__image {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  transition: transform 0.3s ease;\n}\n\n.product-card:hover .product-card__image {\n  transform: scale(1.05);\n}\n\n/* Element: product-card__details */\n.product-card__details {\n  padding: 1rem;\n  flex: 1;\n}\n\n/* Element: product-card__title */\n.product-card__title {\n  font-size: 1.125rem;\n  font-weight: 600;\n  color: #1a1a1a;\n  margin: 0 0 0.5rem 0;\n  line-height: 1.4;\n}\n\n/* Element: product-card__price */\n.product-card__price {\n  font-size: 1.25rem;\n  font-weight: 700;\n  color: #d32f2f;\n  margin: 0 0 0.75rem 0;\n}\n\n/* Element: product-card__description */\n.product-card__description {\n  font-size: 0.875rem;\n  color: #666666;\n  line-height: 1.6;\n  margin: 0;\n}\n\n/* Element: product-card__actions */\n.product-card__actions {\n  padding: 1rem;\n  display: flex;\n  gap: 0.5rem;\n  border-top: 1px solid #e0e0e0;\n}\n\n/* Element: product-card__button */\n.product-card__button {\n  flex: 1;\n  padding: 0.75rem 1rem;\n  font-size: 0.875rem;\n  font-weight: 600;\n  border: none;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  text-align: center;\n}\n\n/* Modifier: product-card__button--primary */\n.product-card__button--primary {\n  background: #d32f2f;\n  color: #ffffff;\n}\n\n.product-card__button--primary:hover {\n  background: #b71c1c;\n}\n\n.product-card__button--primary:active {\n  background: #8b0000;\n}\n\n/* Modifier: product-card__button--secondary */\n.product-card__button--secondary {\n  background: #ffffff;\n  color: #1a1a1a;\n  border: 1px solid #e0e0e0;\n}\n\n.product-card__button--secondary:hover {\n  background: #f5f5f5;\n}\n\n/* State: Button loading */\n.product-card__button[data-state=\"loading\"] {\n  opacity: 0.6;\n  cursor: wait;\n  pointer-events: none;\n}\n\n/* State: Button success */\n.product-card__button[data-state=\"success\"] {\n  background: #2e7d32;\n  color: #ffffff;\n}\n\n/* State: Button disabled */\n.product-card__button:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .product-card__actions {\n    flex-direction: column;\n  }\n  \n  .product-card__button {\n    width: 100%;\n  }\n}"
  },
  {
    "id": "gtm-configuration",
    "title": "GTM Tag Configuration",
    "description": "Complete Google Tag Manager setup for GA4 events with UCP parameters",
    "category": "gtm",
    "tags": ["gtm", "ga4", "configuration", "data-layer", "variables"],
    "language": "javascript",
    "order": 6,
    "code": "/**\n * Google Tag Manager Configuration\n * \n * Tag: GA4 - Add to Cart Event\n * Type: Google Analytics: GA4 Event\n * Trigger: Custom Event = 'add_to_cart'\n */\n\n// Event Name: add_to_cart\n\n// Event Parameters:\n{\n  // User identification\n  user_id: {{DLV - user_id}},\n  \n  // UCP Context\n  ucp_token_hash: {{DLV - ucp_token_hash}},\n  ucp_session_id: {{DLV - ucp_session_id}},\n  ucp_entity_type: {{DLV - ucp_entity_type}},\n  ucp_product_id: {{DLV - ucp_product_id}},\n  ucp_product_sku: {{DLV - ucp_product_sku}},\n  \n  // Element Context\n  element_id: {{DLV - element_id}},\n  element_class: {{DLV - element_class}},\n  element_label: {{DLV - element_label}},\n  element_action: {{DLV - element_action}},\n  \n  // Ecommerce Data (automatically captured)\n  currency: {{DLV - ecommerce.currency}},\n  value: {{DLV - ecommerce.value}},\n  items: {{DLV - ecommerce.items}}\n}\n\n/**\n * Data Layer Variables (DLV) to Create:\n */\n\n// Variable: DLV - user_id\n// Type: Data Layer Variable\n// Data Layer Variable Name: user_id\n\n// Variable: DLV - ucp_token_hash\n// Type: Data Layer Variable\n// Data Layer Variable Name: ucp_token_hash\n\n// Variable: DLV - ucp_session_id\n// Type: Data Layer Variable\n// Data Layer Variable Name: ucp_session_id\n\n// Variable: DLV - element_class\n// Type: Data Layer Variable\n// Data Layer Variable Name: element_class\n\n// Variable: DLV - element_action\n// Type: Data Layer Variable\n// Data Layer Variable Name: element_action\n\n// Variable: DLV - ecommerce.items\n// Type: Data Layer Variable\n// Data Layer Variable Name: ecommerce.items\n\n/**\n * Trigger Configuration:\n */\n\n// Trigger: Custom Event - add_to_cart\n// Type: Custom Event\n// Event name: add_to_cart\n// This trigger fires on: All Custom Events\n\n/**\n * Tag: GA4 - Purchase Event\n * Type: Google Analytics: GA4 Event\n * Trigger: Custom Event = 'purchase'\n */\n\n// Event Name: purchase\n\n// Event Parameters:\n{\n  user_id: {{DLV - user_id}},\n  ucp_token_hash: {{DLV - ucp_token_hash}},\n  ucp_session_id: {{DLV - ucp_session_id}},\n  ucp_checkout_id: {{DLV - ucp_checkout_id}},\n  ucp_payment_method: {{DLV - ucp_payment_method}},\n  ucp_fulfillment_method: {{DLV - ucp_fulfillment_method}},\n  \n  // Transaction data (automatically captured from ecommerce object)\n  transaction_id: {{DLV - ecommerce.transaction_id}},\n  affiliation: {{DLV - ecommerce.affiliation}},\n  value: {{DLV - ecommerce.value}},\n  tax: {{DLV - ecommerce.tax}},\n  shipping: {{DLV - ecommerce.shipping}},\n  currency: {{DLV - ecommerce.currency}},\n  coupon: {{DLV - ecommerce.coupon}},\n  items: {{DLV - ecommerce.items}}\n}\n\n/**\n * Debug Mode:\n * Enable GA4 DebugView by adding ?debug_mode=true to URL\n * Or set debug_mode: true in dataLayer push\n */\n\nwindow.dataLayer.push({\n  event: 'add_to_cart',\n  debug_mode: true, // Enable for testing\n  // ... rest of event data\n});"
  },
  {
    "id": "complete-integration",
    "title": "Complete Integration Flow",
    "description": "Full implementation showing how all components work together from HTML to GA4",
    "category": "integration",
    "tags": ["full-stack", "integration", "workflow", "implementation"],
    "language": "javascript",
    "order": 7,
    "code": "/**\n * Complete GA4 + UCP Integration Flow\n * This example shows the full implementation from page load to event tracking\n */\n\n// Step 1: Initialize on page load\ndocument.addEventListener('DOMContentLoaded', async function() {\n  \n  // Initialize UCP Integration\n  const ucp = new UCPIntegration({\n    middlewareUrl: 'https://your-middleware.xano.io/api:v1'\n  });\n  \n  // Wait for UCP to initialize\n  await ucp.init();\n  \n  // Initialize GA4 Tracker\n  const ga4Tracker = new GA4EventTracker(ucp);\n  \n  // Step 2: Set up event listeners\n  setupEventListeners(ga4Tracker);\n  \n  // Step 3: Track page view\n  trackPageView(ucp);\n});\n\n/**\n * Set up all event listeners\n */\nfunction setupEventListeners(ga4Tracker) {\n  \n  // Add to Cart\n  document.addEventListener('click', function(event) {\n    const button = event.target.closest('.product-card__button[data-action=\"add-to-cart\"]');\n    if (button) {\n      event.preventDefault();\n      handleAddToCart(button, ga4Tracker);\n    }\n  });\n  \n  // Begin Checkout\n  document.addEventListener('click', function(event) {\n    const button = event.target.closest('.checkout-button');\n    if (button) {\n      event.preventDefault();\n      handleBeginCheckout(ga4Tracker);\n    }\n  });\n}\n\n/**\n * Handle Add to Cart action\n */\nfunction handleAddToCart(button, ga4Tracker) {\n  // Update button state\n  button.setAttribute('data-state', 'loading');\n  button.textContent = 'Adding...';\n  \n  // Track GA4 event\n  ga4Tracker.trackAddToCart(button);\n  \n  // Add to cart (API call)\n  const itemData = {\n    product_id: button.getAttribute('data-item-id'),\n    name: button.getAttribute('data-item-name'),\n    price: parseFloat(button.getAttribute('data-item-price')),\n    quantity: 1\n  };\n  \n  addToCartAPI(itemData)\n    .then(() => {\n      // Success state\n      button.setAttribute('data-state', 'success');\n      button.textContent = 'Added!';\n      \n      // Update cart count in header\n      updateCartCount();\n      \n      // Reset button after 2 seconds\n      setTimeout(() => {\n        button.removeAttribute('data-state');\n        button.textContent = 'Add to Cart';\n      }, 2000);\n    })\n    .catch(error => {\n      console.error('Add to cart failed:', error);\n      button.removeAttribute('data-state');\n      button.textContent = 'Error - Try Again';\n    });\n}\n\n/**\n * Handle Begin Checkout\n */\nfunction handleBeginCheckout(ga4Tracker) {\n  const cartData = getCartData();\n  \n  if (cartData.items.length === 0) {\n    alert('Your cart is empty');\n    return;\n  }\n  \n  // Track begin_checkout\n  ga4Tracker.trackBeginCheckout(cartData);\n  \n  // Navigate to checkout\n  window.location.href = '/checkout';\n}\n\n/**\n * Track page view\n */\nfunction trackPageView(ucp) {\n  window.dataLayer.push({\n    event: 'page_view',\n    user_id: ucp.userId,\n    ucp_token_hash: ucp.getHashedToken(),\n    ucp_session_id: ucp.sessionId,\n    page_path: window.location.pathname,\n    page_title: document.title\n  });\n}\n\n/**\n * API: Add item to cart\n */\nfunction addToCartAPI(itemData) {\n  return fetch('/api/cart/add', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(itemData)\n  }).then(response => {\n    if (!response.ok) throw new Error('API Error');\n    return response.json();\n  });\n}\n\n/**\n * Get cart data from localStorage\n */\nfunction getCartData() {\n  const items = JSON.parse(localStorage.getItem('cart') || '[]');\n  const total = items.reduce((sum, item) => sum + (item.price * item.quantity), 0);\n  \n  return {\n    checkout_id: 'chk_' + Date.now(),\n    currency: 'USD',\n    total: total,\n    items: items\n  };\n}\n\n/**\n * Update cart count badge\n */\nfunction updateCartCount() {\n  const cart = JSON.parse(localStorage.getItem('cart') || '[]');\n  const count = cart.reduce((sum, item) => sum + item.quantity, 0);\n  \n  const badge = document.querySelector('.cart-badge');\n  if (badge) {\n    badge.textContent = count;\n    badge.style.display = count > 0 ? 'block' : 'none';\n  }\n}"
  }
]
